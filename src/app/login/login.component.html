<div class="login-container">
  <div class="login-card">
    <div class="login-header">
      <h2>Welcome to ProductStore</h2>
      <div class="tab-buttons">
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'login'"
          (click)="switchTab('login')">
          Login
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'register'"
          (click)="switchTab('register')">
          Register
        </button>
      </div>
    </div>

    <!-- Message Display -->
    <div *ngIf="message" class="message" [class.success]="messageType === 'success'" [class.error]="messageType === 'error'">
      {{ message }}
    </div>

    <!-- Login Form -->
    <form *ngIf="activeTab === 'login'" (ngSubmit)="onLogin()" class="auth-form" #loginForm="ngForm">
      <div class="form-group">
        <label for="loginEmail">Email Address</label>
        <input 
          type="email" 
          id="loginEmail" 
          [(ngModel)]="loginData.email" 
          name="loginEmail"
          placeholder="Enter your email address"
          class="form-input">
      </div>

      <div class="divider">
        <span>OR</span>
      </div>

      <div class="form-group">
        <label for="loginPhone">Phone Number</label>
        <div class="phone-input-container">
          <span class="phone-code">+27</span>
          <input 
            type="tel" 
            id="loginPhone" 
            [(ngModel)]="loginData.phoneNumber" 
            name="loginPhone"
            placeholder="Enter 10-digit phone number"
            class="phone-input"
            maxlength="10"
            (input)="onPhoneNumberInput($event)">
        </div>
        <small class="input-hint">Enter your 10-digit South African phone number</small>
      </div>

      <div class="form-group">
        <label for="loginPassword">Password</label>
        <input 
          type="password" 
          id="loginPassword" 
          [(ngModel)]="loginData.password" 
          name="loginPassword"
          placeholder="Enter your password"
          class="form-input">
      </div>

      <button 
        type="submit" 
        class="submit-button" 
        [disabled]="loading">
        <span *ngIf="loading" class="loading-spinner"></span>
        {{ loading ? 'Logging in...' : 'Login' }}
      </button>
    </form>

    <!-- Registration Form -->
    <form *ngIf="activeTab === 'register'" (ngSubmit)="onRegister()" class="auth-form" #registerForm="ngForm">
      <div class="form-row">
        <div class="form-group">
          <label for="firstName">First Name *</label>
          <input 
            type="text" 
            id="firstName" 
            [(ngModel)]="registerData.firstName" 
            name="firstName"
            required
            placeholder="First name"
            class="form-input">
        </div>

        <div class="form-group">
          <label for="lastName">Surname *</label>
          <input 
            type="text" 
            id="lastName" 
            [(ngModel)]="registerData.lastName" 
            name="lastName"
            required
            placeholder="Surname"
            class="form-input">
        </div>
      </div>

      <div class="form-group">
        <label for="registerEmail">Email Address *</label>
        <input 
          type="email" 
          id="registerEmail" 
          [(ngModel)]="registerData.email" 
          name="registerEmail"
          required
          placeholder="Enter your email address"
          class="form-input">
        <small class="input-hint">We'll use this for account verification and updates</small>
      </div>

      <div class="form-group">
        <label for="country">Country *</label>
        <select 
          id="country" 
          [(ngModel)]="registerData.country" 
          name="country"
          required 
          class="form-select">
          <option *ngFor="let country of countries" [value]="country.code">
            {{ country.flag }} {{ country.name }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="registerPhone">Phone Number *</label>
        <div class="phone-input-container">
          <span class="phone-code">{{ getSelectedCountry().phoneCode }}</span>
          <input 
            type="tel" 
            id="registerPhone" 
            [(ngModel)]="registerData.phoneNumber" 
            name="registerPhone"
            required
            [placeholder]="getSelectedCountry().code === 'ZA' ? 'Enter 10-digit number' : 'Enter phone number'"
            class="phone-input"
            [maxlength]="getSelectedCountry().code === 'ZA' ? '10' : '15'"
            (input)="onPhoneNumberInput($event)">
        </div>
        <small class="input-hint" *ngIf="getSelectedCountry().code === 'ZA'">
          Enter your 10-digit South African phone number (e.g., 0123456789)
        </small>
        <small class="input-hint" *ngIf="getSelectedCountry().code !== 'ZA'">
          Enter your phone number for {{ getSelectedCountry().name }}
        </small>
      </div>

      <div class="form-group">
        <label for="registerPassword">Password *</label>
        <input 
          type="password" 
          id="registerPassword" 
          [(ngModel)]="registerData.password" 
          name="registerPassword"
          required
          placeholder="Create a strong password"
          class="form-input">
        
        <!-- Password Strength Indicator -->
        <div class="password-strength" *ngIf="registerData.password">
          <div class="strength-bar">
            <div class="strength-fill" 
                 [style.width.%]="getPasswordStrength(registerData.password).percentage"
                 [style.background-color]="getPasswordStrengthColor(getPasswordStrength(registerData.password).strength)">
            </div>
          </div>
          <span class="strength-text" 
                [style.color]="getPasswordStrengthColor(getPasswordStrength(registerData.password).strength)">
            {{ getPasswordStrength(registerData.password).strength }}
          </span>
        </div>

        <!-- Password Requirements -->
        <div class="password-requirements" *ngIf="registerData.password">
          <small class="requirements-title">Password must contain:</small>
          <div class="requirements-list">
            <div class="requirement" 
                 [class.met]="getPasswordStrength(registerData.password).requirements.length">
              <span class="requirement-icon">{{ getPasswordStrength(registerData.password).requirements.length ? '✓' : '✗' }}</span>
              At least 8 characters
            </div>
            <div class="requirement" 
                 [class.met]="getPasswordStrength(registerData.password).requirements.uppercase">
              <span class="requirement-icon">{{ getPasswordStrength(registerData.password).requirements.uppercase ? '✓' : '✗' }}</span>
              One uppercase letter (A-Z)
            </div>
            <div class="requirement" 
                 [class.met]="getPasswordStrength(registerData.password).requirements.lowercase">
              <span class="requirement-icon">{{ getPasswordStrength(registerData.password).requirements.lowercase ? '✓' : '✗' }}</span>
              One lowercase letter (a-z)
            </div>
            <div class="requirement" 
                 [class.met]="getPasswordStrength(registerData.password).requirements.number">
              <span class="requirement-icon">{{ getPasswordStrength(registerData.password).requirements.number ? '✓' : '✗' }}</span>
              One number (0-9)
            </div>
            <div class="requirement" 
                 [class.met]="getPasswordStrength(registerData.password).requirements.special">
              <span class="requirement-icon">{{ getPasswordStrength(registerData.password).requirements.special ? '✓' : '✗' }}</span>
              One special character (!@#$%^&*)
            </div>
          </div>
        </div>
        <small class="input-hint" *ngIf="!registerData.password">
          Password must be at least 8 characters with uppercase, lowercase, number and special character
        </small>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password *</label>
        <input 
          type="password" 
          id="confirmPassword" 
          [(ngModel)]="registerData.confirmPassword" 
          name="confirmPassword"
          required
          placeholder="Confirm your password"
          class="form-input"
          [class.password-match]="registerData.password && registerData.confirmPassword && registerData.password === registerData.confirmPassword"
          [class.password-mismatch]="registerData.password && registerData.confirmPassword && registerData.password !== registerData.confirmPassword">
        
        <!-- Password Match Indicator -->
        <div class="password-match-indicator" *ngIf="registerData.confirmPassword">
          <small *ngIf="registerData.password === registerData.confirmPassword" class="match-success">
            ✓ Passwords match
          </small>
          <small *ngIf="registerData.password !== registerData.confirmPassword" class="match-error">
            ✗ Passwords do not match
          </small>
        </div>
      </div>

      <button 
        type="submit" 
        class="submit-button" 
        [disabled]="loading || !isRegistrationFormValid()">
        <span *ngIf="loading" class="loading-spinner"></span>
        {{ loading ? 'Creating Account...' : 'Create Account' }}
      </button>
    </form>
  </div>
</div>